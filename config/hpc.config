process {
    executor = 'pbspro'

            // This script runs on the PBS compute node before the R script
            beforeScript = '''
            module load gcc/12.2.0
            module load intel/basekit/INITIALIZE/2023.0.0
            module load intel/basekit/mkl/2023.0.0
            module load cuda/toolkit/
            module load libxkbcommon/1.0.3
            module load R/4.4.0
            module load singularity/4.3.0
            '''
            
            // HPC-specific flags
            clusterOptions = '-W group_list=cu_10031 -A cu_10031'
            cache = 'lenient'
            stageInMode = 'symlink'
        }

        
        // --- PBS Pro Specific Configuration ---
        pbspro {
            executor {
                queueSize = 30
            }
        }
        
        // --- Singularity Configuration ---
        singularity {
            enabled = true
            autoMounts = true
            cacheDir = "$projectDir/singularity_cache" 
        }



